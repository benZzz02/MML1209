# Training
n_ctx: 4
checkpoint: cholec_vals/GPRLoss    # For saving checkpoints
log_file: surgadapt+cholec_GPRLoss.txt
model_name: surgadapt_gcn
batch_size: 39
lr: 1e-5
epochs: 15
reweight_p: 0.2
relation_file: cholec/word2vec_similarity_matrix.npy
ratio: 1
#parent_n_ctx: 4
#parent_ctx_init: a photo of a
child_n_ctx: 4
child_ctx_init: a photo
change_epoch: 1 # Warmup epoch
tau: 0.6
image_size: 224
num_classes: 110
super_labels: cholec/cholec_super_labels.txt
super_labels_index: cholec/cholec_labels_index.npy
child_num: 110
label_file: label_jsons/data1.json  # Label file for initialization
val_sp : True # If single positive validation
val_methods : ['pp_map', 'pp_loss', 'sp_loss'] # Methods for saving loss
perform_init : False  # Perform model initialization with triplet pseudolabels
init_train_file : triplet_train_labels.json # Init labels
init_val_file : triplet_val_labels.json # Init labels
init_epochs : 5
init_lr : 1e-5
dir : trial_GPRLoss  # Directory to save results
loss : GPRLoss  # Loss function
use_lfile : False  # If use label file
getitem : False # If call random in getitem
# Random in init if both false
backbone : ViT-L/14
seed: 0  # Set seed
partial: True # For partial positive data in training
model: SurgAdapt
#bert_path : /home/swalimbe/surgvlp_trial/Bio_ClinicalBERT  # Bert init for SurgVLP
#vlp_weights : /home/swalimbe/surgvlp_trial/nips_v1.tar # Ckpt for SurgVLP

# --- GPRLoss Specific Parameters ---  <- 新增一个专门的区域，让配置更清晰
gpr_loss:
  beta: [0, 2, -2, -2]
  alpha: [0.5, 2, 0.8, 0.5]
  q: [0.01, 1]
  lam: [0.8, 0.3]
  rho: 0.9
  reg: 0.001
  use_pl: True
  pl_epoch_start: 1      # 和你的 change_epoch 作用类似，可以考虑统一
  expected_num_pos: 1.0  # 建议添加这个参数，即使使用默认值
  # num_classes 已经在上面定义了，可以复用

# Testing
ckpt: temp.ckpt  # Ckpt path for inference
test_dir: trial_GPRLoss_test # Directory to save results
test_loss: GPRLoss  # Loss function